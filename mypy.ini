[mypy]
python_version = 3.12
warn_unused_configs = True
warn_redundant_casts = True
warn_unused_ignores = True
warn_return_any = True
no_implicit_optional = True
strict_equality = True
disallow_incomplete_defs = True
disallow_untyped_defs = True
show_error_codes = True
ignore_missing_imports = True
exclude = (?x)
	^tests/.*$ |           # top-level tests
	.*/tests/.*$           # nested tests in packages
	| ^packages/mcp-servers/knowledge-mcp/src/knowledge_mcp/models\.py$  # TEMP: mypy internal error under trunk runner
	| ^packages/mcp-servers/router-mcp/src/router_mcp/models\.py$         # TEMP: mypy internal error under trunk runner
	| ^src/knowledge_mcp/models\.py$                                      # TEMP: when invoked from package root
	| ^src/router_mcp/models\.py$                                         # TEMP: when invoked from package root

# Module-specific configuration (incremental expansion)

# Correct module pattern for the FastAPI app factory
[mypy-stratmaster_api.app]
disable_error_code = no-any-return

# Keep API strict by default; adjust per-submodule if needed
[mypy-stratmaster_api.*]
warn_return_any = True
disallow_untyped_defs = True

# Start typing MCP servers with relaxed function annotations, then tighten later
[mypy-research_mcp.*]
disallow_untyped_defs = False

[mypy-knowledge_mcp.*]
disallow_untyped_defs = False

[mypy-router_mcp.*]
disallow_untyped_defs = False

[mypy-evals_mcp.*]
disallow_untyped_defs = False

[mypy-compression_mcp.*]
disallow_untyped_defs = False

# Strategy pipeline package (incremental typing)
[mypy-strategy_pipeline.*]
disallow_untyped_defs = False

[mypy-router_mcp.models]
ignore_errors = True

[mypy-knowledge_mcp.models]
ignore_errors = True
