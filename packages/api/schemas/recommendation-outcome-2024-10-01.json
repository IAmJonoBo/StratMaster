{
  "$defs": {
    "Assumption": {
      "additionalProperties": false,
      "properties": {
        "confidence": {
          "maximum": 1,
          "minimum": 0,
          "title": "Confidence",
          "type": "number"
        },
        "id": {
          "title": "Id",
          "type": "string"
        },
        "provenance_ids": {
          "items": {
            "type": "string"
          },
          "title": "Provenance Ids",
          "type": "array"
        },
        "statement": {
          "title": "Statement",
          "type": "string"
        }
      },
      "required": [
        "id",
        "statement",
        "confidence",
        "provenance_ids"
      ],
      "title": "Assumption",
      "type": "object"
    },
    "CEP": {
      "additionalProperties": false,
      "properties": {
        "id": {
          "title": "Id",
          "type": "string"
        },
        "jobs_to_be_done": {
          "items": {
            "type": "string"
          },
          "title": "Jobs To Be Done",
          "type": "array"
        },
        "narrative": {
          "title": "Narrative",
          "type": "string"
        },
        "title": {
          "title": "Title",
          "type": "string"
        }
      },
      "required": [
        "id",
        "title",
        "narrative",
        "jobs_to_be_done"
      ],
      "title": "CEP",
      "type": "object"
    },
    "Claim": {
      "additionalProperties": false,
      "properties": {
        "evidence_grade": {
          "$ref": "#/$defs/EvidenceGrade"
        },
        "id": {
          "title": "Id",
          "type": "string"
        },
        "provenance_ids": {
          "items": {
            "type": "string"
          },
          "title": "Provenance Ids",
          "type": "array"
        },
        "statement": {
          "title": "Statement",
          "type": "string"
        }
      },
      "required": [
        "id",
        "statement",
        "evidence_grade",
        "provenance_ids"
      ],
      "title": "Claim",
      "type": "object"
    },
    "CommunityScore": {
      "additionalProperties": false,
      "properties": {
        "community_id": {
          "description": "Identifier for the detected community",
          "title": "Community Id",
          "type": "string"
        },
        "score": {
          "maximum": 1,
          "minimum": 0,
          "title": "Score",
          "type": "number"
        }
      },
      "required": [
        "community_id",
        "score"
      ],
      "title": "CommunityScore",
      "type": "object"
    },
    "CommunitySummary": {
      "additionalProperties": false,
      "properties": {
        "community_id": {
          "title": "Community Id",
          "type": "string"
        },
        "key_entities": {
          "items": {
            "type": "string"
          },
          "title": "Key Entities",
          "type": "array"
        },
        "summary": {
          "title": "Summary",
          "type": "string"
        }
      },
      "required": [
        "community_id",
        "summary",
        "key_entities"
      ],
      "title": "CommunitySummary",
      "type": "object"
    },
    "DBA": {
      "additionalProperties": false,
      "properties": {
        "assumption_ids": {
          "items": {
            "type": "string"
          },
          "title": "Assumption Ids",
          "type": "array"
        },
        "bet": {
          "title": "Bet",
          "type": "string"
        },
        "decision": {
          "title": "Decision",
          "type": "string"
        },
        "id": {
          "title": "Id",
          "type": "string"
        }
      },
      "required": [
        "id",
        "decision",
        "bet",
        "assumption_ids"
      ],
      "title": "DBA",
      "type": "object"
    },
    "DebateTrace": {
      "additionalProperties": false,
      "properties": {
        "turns": {
          "items": {
            "$ref": "#/$defs/DebateTurn"
          },
          "title": "Turns",
          "type": "array"
        },
        "verdict": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Verdict"
        }
      },
      "required": [
        "turns"
      ],
      "title": "DebateTrace",
      "type": "object"
    },
    "DebateTurn": {
      "additionalProperties": false,
      "properties": {
        "agent": {
          "title": "Agent",
          "type": "string"
        },
        "content": {
          "title": "Content",
          "type": "string"
        },
        "grounding": {
          "items": {
            "$ref": "#/$defs/GroundingSpan"
          },
          "title": "Grounding",
          "type": "array"
        },
        "role": {
          "enum": [
            "Researcher",
            "Synthesiser",
            "Strategist",
            "Adversary",
            "ConstitutionalCritic",
            "Recommender"
          ],
          "title": "Role",
          "type": "string"
        }
      },
      "required": [
        "agent",
        "role",
        "content"
      ],
      "title": "DebateTurn",
      "type": "object"
    },
    "DecisionBrief": {
      "additionalProperties": false,
      "properties": {
        "assumptions": {
          "items": {
            "$ref": "#/$defs/Assumption"
          },
          "title": "Assumptions",
          "type": "array"
        },
        "cep": {
          "$ref": "#/$defs/CEP"
        },
        "claims": {
          "items": {
            "$ref": "#/$defs/Claim"
          },
          "title": "Claims",
          "type": "array"
        },
        "confidence": {
          "maximum": 1,
          "minimum": 0,
          "title": "Confidence",
          "type": "number"
        },
        "dbas": {
          "items": {
            "$ref": "#/$defs/DBA"
          },
          "title": "Dbas",
          "type": "array"
        },
        "evidence_grade": {
          "$ref": "#/$defs/EvidenceGrade"
        },
        "experiments": {
          "items": {
            "$ref": "#/$defs/Experiment"
          },
          "title": "Experiments",
          "type": "array"
        },
        "forecasts": {
          "items": {
            "$ref": "#/$defs/Forecast"
          },
          "title": "Forecasts",
          "type": "array"
        },
        "id": {
          "title": "Id",
          "type": "string"
        },
        "jtbd": {
          "items": {
            "$ref": "#/$defs/JTBD"
          },
          "title": "Jtbd",
          "type": "array"
        },
        "provenance_ids": {
          "items": {
            "type": "string"
          },
          "title": "Provenance Ids",
          "type": "array"
        },
        "recommendation": {
          "title": "Recommendation",
          "type": "string"
        },
        "safer_alternative": {
          "title": "Safer Alternative",
          "type": "string"
        }
      },
      "required": [
        "id",
        "cep",
        "jtbd",
        "dbas",
        "assumptions",
        "claims",
        "experiments",
        "forecasts",
        "recommendation",
        "safer_alternative",
        "evidence_grade",
        "provenance_ids",
        "confidence"
      ],
      "title": "DecisionBrief",
      "type": "object"
    },
    "EvidenceGrade": {
      "enum": [
        "high",
        "moderate",
        "low",
        "insufficient"
      ],
      "title": "EvidenceGrade",
      "type": "string"
    },
    "Experiment": {
      "additionalProperties": false,
      "properties": {
        "hypothesis_id": {
          "title": "Hypothesis Id",
          "type": "string"
        },
        "id": {
          "title": "Id",
          "type": "string"
        },
        "launch_conditions": {
          "items": {
            "type": "string"
          },
          "title": "Launch Conditions",
          "type": "array"
        },
        "minimum_detectable_effect": {
          "title": "Minimum Detectable Effect",
          "type": "number"
        },
        "primary_metric": {
          "$ref": "#/$defs/Metric"
        },
        "variants": {
          "items": {
            "$ref": "#/$defs/ExperimentVariant"
          },
          "title": "Variants",
          "type": "array"
        }
      },
      "required": [
        "id",
        "hypothesis_id",
        "variants",
        "primary_metric",
        "minimum_detectable_effect"
      ],
      "title": "Experiment",
      "type": "object"
    },
    "ExperimentVariant": {
      "additionalProperties": false,
      "properties": {
        "description": {
          "title": "Description",
          "type": "string"
        },
        "name": {
          "title": "Name",
          "type": "string"
        },
        "prior_probability": {
          "anyOf": [
            {
              "maximum": 1,
              "minimum": 0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Prior Probability"
        }
      },
      "required": [
        "name",
        "description"
      ],
      "title": "ExperimentVariant",
      "type": "object"
    },
    "Forecast": {
      "additionalProperties": false,
      "properties": {
        "horizon_days": {
          "title": "Horizon Days",
          "type": "integer"
        },
        "id": {
          "title": "Id",
          "type": "string"
        },
        "intervals": {
          "items": {
            "$ref": "#/$defs/ForecastInterval"
          },
          "title": "Intervals",
          "type": "array"
        },
        "metric": {
          "$ref": "#/$defs/Metric"
        },
        "point_estimate": {
          "title": "Point Estimate",
          "type": "number"
        }
      },
      "required": [
        "id",
        "metric",
        "point_estimate",
        "intervals",
        "horizon_days"
      ],
      "title": "Forecast",
      "type": "object"
    },
    "ForecastInterval": {
      "additionalProperties": false,
      "properties": {
        "confidence": {
          "enum": [
            50,
            90
          ],
          "title": "Confidence",
          "type": "integer"
        },
        "lower": {
          "title": "Lower",
          "type": "number"
        },
        "upper": {
          "title": "Upper",
          "type": "number"
        }
      },
      "required": [
        "confidence",
        "lower",
        "upper"
      ],
      "title": "ForecastInterval",
      "type": "object"
    },
    "GraphArtifacts": {
      "additionalProperties": false,
      "properties": {
        "communities": {
          "items": {
            "$ref": "#/$defs/CommunityScore"
          },
          "title": "Communities",
          "type": "array"
        },
        "community_summaries": {
          "items": {
            "$ref": "#/$defs/CommunitySummary"
          },
          "title": "Community Summaries",
          "type": "array"
        },
        "edges": {
          "items": {
            "$ref": "#/$defs/GraphEdge"
          },
          "title": "Edges",
          "type": "array"
        },
        "narrative_chunks": {
          "items": {
            "$ref": "#/$defs/NarrativeChunk"
          },
          "title": "Narrative Chunks",
          "type": "array"
        },
        "nodes": {
          "items": {
            "$ref": "#/$defs/GraphNode"
          },
          "title": "Nodes",
          "type": "array"
        }
      },
      "required": [
        "nodes",
        "edges",
        "communities",
        "community_summaries",
        "narrative_chunks"
      ],
      "title": "GraphArtifacts",
      "type": "object"
    },
    "GraphEdge": {
      "additionalProperties": false,
      "properties": {
        "relation": {
          "title": "Relation",
          "type": "string"
        },
        "source": {
          "title": "Source",
          "type": "string"
        },
        "target": {
          "title": "Target",
          "type": "string"
        },
        "weight": {
          "anyOf": [
            {
              "minimum": 0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Weight"
        }
      },
      "required": [
        "source",
        "target",
        "relation"
      ],
      "title": "GraphEdge",
      "type": "object"
    },
    "GraphNode": {
      "additionalProperties": false,
      "properties": {
        "id": {
          "title": "Id",
          "type": "string"
        },
        "label": {
          "title": "Label",
          "type": "string"
        },
        "score": {
          "anyOf": [
            {
              "minimum": 0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Score"
        },
        "type": {
          "title": "Type",
          "type": "string"
        }
      },
      "required": [
        "id",
        "label",
        "type"
      ],
      "title": "GraphNode",
      "type": "object"
    },
    "GroundingSpan": {
      "additionalProperties": false,
      "properties": {
        "chunk_hash": {
          "title": "Chunk Hash",
          "type": "string"
        },
        "end_char": {
          "minimum": 0,
          "title": "End Char",
          "type": "integer"
        },
        "source_id": {
          "title": "Source Id",
          "type": "string"
        },
        "start_char": {
          "minimum": 0,
          "title": "Start Char",
          "type": "integer"
        }
      },
      "required": [
        "source_id",
        "chunk_hash",
        "start_char",
        "end_char"
      ],
      "title": "GroundingSpan",
      "type": "object"
    },
    "JTBD": {
      "additionalProperties": false,
      "properties": {
        "actor": {
          "title": "Actor",
          "type": "string"
        },
        "id": {
          "title": "Id",
          "type": "string"
        },
        "motivation": {
          "title": "Motivation",
          "type": "string"
        },
        "outcome": {
          "title": "Outcome",
          "type": "string"
        }
      },
      "required": [
        "id",
        "actor",
        "motivation",
        "outcome"
      ],
      "title": "JTBD",
      "type": "object"
    },
    "Metric": {
      "additionalProperties": false,
      "properties": {
        "current_value": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Current Value"
        },
        "definition": {
          "title": "Definition",
          "type": "string"
        },
        "id": {
          "title": "Id",
          "type": "string"
        },
        "name": {
          "title": "Name",
          "type": "string"
        },
        "unit": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Unit"
        }
      },
      "required": [
        "id",
        "name",
        "definition"
      ],
      "title": "Metric",
      "type": "object"
    },
    "NarrativeChunk": {
      "additionalProperties": false,
      "properties": {
        "id": {
          "title": "Id",
          "type": "string"
        },
        "supporting_claims": {
          "items": {
            "type": "string"
          },
          "title": "Supporting Claims",
          "type": "array"
        },
        "text": {
          "title": "Text",
          "type": "string"
        }
      },
      "required": [
        "id",
        "text",
        "supporting_claims"
      ],
      "title": "NarrativeChunk",
      "type": "object"
    },
    "RecommendationStatus": {
      "description": "Lifecycle status for a recommendation.",
      "enum": [
        "complete",
        "needs_review",
        "failed"
      ],
      "title": "RecommendationStatus",
      "type": "string"
    },
    "RetrievalRecord": {
      "additionalProperties": false,
      "properties": {
        "chunk_hash": {
          "title": "Chunk Hash",
          "type": "string"
        },
        "document_id": {
          "title": "Document Id",
          "type": "string"
        },
        "grounding_spans": {
          "items": {
            "$ref": "#/$defs/GroundingSpan"
          },
          "title": "Grounding Spans",
          "type": "array"
        },
        "provenance_id": {
          "title": "Provenance Id",
          "type": "string"
        },
        "scores": {
          "$ref": "#/$defs/RetrievalScore"
        }
      },
      "required": [
        "document_id",
        "scores",
        "grounding_spans",
        "chunk_hash",
        "provenance_id"
      ],
      "title": "RetrievalRecord",
      "type": "object"
    },
    "RetrievalScore": {
      "additionalProperties": false,
      "properties": {
        "dense_score": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Dense Score"
        },
        "hybrid_score": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Hybrid Score"
        },
        "reranker_score": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Reranker Score"
        },
        "sparse_score": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Sparse Score"
        }
      },
      "title": "RetrievalScore",
      "type": "object"
    },
    "WorkflowMetadata": {
      "additionalProperties": false,
      "properties": {
        "langfuse_span_id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Langfuse Span Id"
        },
        "tenant_id": {
          "title": "Tenant Id",
          "type": "string"
        },
        "trace_id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Trace Id"
        },
        "workflow_id": {
          "title": "Workflow Id",
          "type": "string"
        }
      },
      "required": [
        "workflow_id",
        "tenant_id"
      ],
      "title": "WorkflowMetadata",
      "type": "object"
    }
  },
  "$id": "https://schemas.stratmaster.ai/recommendation-outcome/2024-10-01",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "additionalProperties": false,
  "properties": {
    "debate": {
      "$ref": "#/$defs/DebateTrace"
    },
    "decision_brief": {
      "$ref": "#/$defs/DecisionBrief"
    },
    "failure_reasons": {
      "items": {
        "type": "string"
      },
      "title": "Failure Reasons",
      "type": "array"
    },
    "graph": {
      "$ref": "#/$defs/GraphArtifacts"
    },
    "metrics": {
      "additionalProperties": {
        "type": "number"
      },
      "title": "Metrics",
      "type": "object"
    },
    "retrieval": {
      "items": {
        "$ref": "#/$defs/RetrievalRecord"
      },
      "title": "Retrieval",
      "type": "array"
    },
    "status": {
      "$ref": "#/$defs/RecommendationStatus",
      "default": "complete"
    },
    "workflow": {
      "$ref": "#/$defs/WorkflowMetadata"
    }
  },
  "required": [
    "decision_brief",
    "debate",
    "retrieval",
    "graph",
    "metrics",
    "workflow"
  ],
  "title": "RecommendationOutcome",
  "type": "object"
}